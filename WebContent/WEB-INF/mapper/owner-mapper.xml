<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="owner">
	
	<!-- 메뉴추가 -->
	<insert id="addMenu" parameterType="pro.vo.MenuVo">
		insert into menu (no,name,price,store)
		values(#{no},#{name},#{price},#{store})
	</insert>
	<!-- 파일추가 -->
	<insert id="addAttach" parameterType="pro.vo.MenuAttachVo">
		insert into menuattach values(menuattach_seq.nextval, #{uri}, #{name}, #{parent})
	</insert>
	<!-- 메뉴삭제 -->
	<delete id="menuDelete">
		delete from menu where no=${no}
	</delete>

	<select id="getSeq" resultType="java.lang.Integer">
		select menu_seq.nextval from dual
	</select>
	
	<select id="getMenuList" parameterType="java.lang.Integer"
		resultType="pro.vo.MenuVo">
		select a.*, b.uri fileUri, b.name fileName from (( select * from menu where store = #{no}) a left join menuattach b on a.no = b.parent)
	</select>

	<select id="getMenu" parameterType="java.lang.Integer"
		resultType="pro.vo.MenuVo">
		select * from menu where no = #{no}
	</select>
</mapper>